{"version":3,"file":"taiga-ui-addon-mobile-services.js","sources":["../../../projects/addon-mobile/services/keyboard.service.ts","../../../projects/addon-mobile/services/taiga-ui-addon-mobile-services.ts"],"sourcesContent":["import {DOCUMENT} from '@angular/common';\nimport {Inject, Injectable, OnDestroy} from '@angular/core';\nimport {tuiGetNativeFocused} from '@taiga-ui/cdk';\nimport {fromEvent, merge} from 'rxjs';\nimport {filter} from 'rxjs/operators';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class TuiKeyboardService implements OnDestroy {\n    private readonly sub = merge(\n        fromEvent(this.doc, 'focusout'),\n        fromEvent(this.doc, 'mousedown').pipe(\n            filter(e => Object.is(e.target, this.element)),\n        ),\n    ).subscribe(() => {\n        this.show();\n    });\n\n    private element?: ElementContentEditable;\n    private inputMode = '';\n\n    constructor(@Inject(DOCUMENT) private readonly doc: Document) {}\n\n    ngOnDestroy(): void {\n        this.sub.unsubscribe();\n        this.show();\n    }\n\n    toggle(): void {\n        if (this.element) {\n            this.show();\n        } else {\n            this.hide();\n        }\n    }\n\n    hide(): void {\n        const focused: any = tuiGetNativeFocused(this.doc);\n\n        if (focused?.inputMode === undefined || this.element) {\n            return;\n        }\n\n        this.element = focused;\n        this.inputMode = focused.inputMode;\n        focused.inputMode = 'none';\n    }\n\n    show(): void {\n        if (!this.element) {\n            return;\n        }\n\n        this.element.inputMode = 'none';\n        this.element.inputMode = this.inputMode;\n        this.element = undefined;\n    }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":";;;;;;;MASa,kBAAkB,CAAA;AAa3B,IAAA,WAAA,CAA+C,GAAa,EAAA;QAAb,IAAG,CAAA,GAAA,GAAH,GAAG,CAAU;QAZ3C,IAAG,CAAA,GAAA,GAAG,KAAK,CACxB,SAAS,CAAC,IAAI,CAAC,GAAG,EAAE,UAAU,CAAC,EAC/B,SAAS,CAAC,IAAI,CAAC,GAAG,EAAE,WAAW,CAAC,CAAC,IAAI,CACjC,MAAM,CAAC,CAAC,IAAI,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC,CACjD,CACJ,CAAC,SAAS,CAAC,MAAK;YACb,IAAI,CAAC,IAAI,EAAE,CAAC;AAChB,SAAC,CAAC,CAAC;QAGK,IAAS,CAAA,SAAA,GAAG,EAAE,CAAC;KAEyC;IAEhE,WAAW,GAAA;AACP,QAAA,IAAI,CAAC,GAAG,CAAC,WAAW,EAAE,CAAC;QACvB,IAAI,CAAC,IAAI,EAAE,CAAC;KACf;IAED,MAAM,GAAA;QACF,IAAI,IAAI,CAAC,OAAO,EAAE;YACd,IAAI,CAAC,IAAI,EAAE,CAAC;AACf,SAAA;AAAM,aAAA;YACH,IAAI,CAAC,IAAI,EAAE,CAAC;AACf,SAAA;KACJ;IAED,IAAI,GAAA;QACA,MAAM,OAAO,GAAQ,mBAAmB,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;AAEnD,QAAA,IAAI,CAAA,OAAO,KAAP,IAAA,IAAA,OAAO,uBAAP,OAAO,CAAE,SAAS,MAAK,SAAS,IAAI,IAAI,CAAC,OAAO,EAAE;YAClD,OAAO;AACV,SAAA;AAED,QAAA,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;AACvB,QAAA,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC;AACnC,QAAA,OAAO,CAAC,SAAS,GAAG,MAAM,CAAC;KAC9B;IAED,IAAI,GAAA;AACA,QAAA,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;YACf,OAAO;AACV,SAAA;AAED,QAAA,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,MAAM,CAAC;QAChC,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;AACxC,QAAA,IAAI,CAAC,OAAO,GAAG,SAAS,CAAC;KAC5B;;AAhDQ,kBAAA,CAAA,IAAA,GAAA,EAAA,CAAA,kBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,SAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,kBAAkB,kBAaP,QAAQ,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,UAAA,EAAA,CAAA,CAAA;AAbnB,kBAAA,CAAA,KAAA,GAAA,EAAA,CAAA,qBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,SAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,kBAAkB,cAFf,MAAM,EAAA,CAAA,CAAA;4FAET,kBAAkB,EAAA,UAAA,EAAA,CAAA;kBAH9B,UAAU;AAAC,YAAA,IAAA,EAAA,CAAA;AACR,oBAAA,UAAU,EAAE,MAAM;AACrB,iBAAA,CAAA;0DAcuD,QAAQ,EAAA,UAAA,EAAA,CAAA;0BAA/C,MAAM;2BAAC,QAAQ,CAAA;;;ACtBhC;;AAEG;;;;"}