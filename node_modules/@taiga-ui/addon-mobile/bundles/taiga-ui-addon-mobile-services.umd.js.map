{"version":3,"file":"taiga-ui-addon-mobile-services.umd.js","sources":["../../../projects/addon-mobile/services/keyboard.service.ts","../../../projects/addon-mobile/services/taiga-ui-addon-mobile-services.ts"],"sourcesContent":["import {DOCUMENT} from '@angular/common';\nimport {Inject, Injectable, OnDestroy} from '@angular/core';\nimport {tuiGetNativeFocused} from '@taiga-ui/cdk';\nimport {fromEvent, merge} from 'rxjs';\nimport {filter} from 'rxjs/operators';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class TuiKeyboardService implements OnDestroy {\n    private readonly sub = merge(\n        fromEvent(this.doc, 'focusout'),\n        fromEvent(this.doc, 'mousedown').pipe(\n            filter(e => Object.is(e.target, this.element)),\n        ),\n    ).subscribe(() => {\n        this.show();\n    });\n\n    private element?: ElementContentEditable;\n    private inputMode = '';\n\n    constructor(@Inject(DOCUMENT) private readonly doc: Document) {}\n\n    ngOnDestroy(): void {\n        this.sub.unsubscribe();\n        this.show();\n    }\n\n    toggle(): void {\n        if (this.element) {\n            this.show();\n        } else {\n            this.hide();\n        }\n    }\n\n    hide(): void {\n        const focused: any = tuiGetNativeFocused(this.doc);\n\n        if (focused?.inputMode === undefined || this.element) {\n            return;\n        }\n\n        this.element = focused;\n        this.inputMode = focused.inputMode;\n        focused.inputMode = 'none';\n    }\n\n    show(): void {\n        if (!this.element) {\n            return;\n        }\n\n        this.element.inputMode = 'none';\n        this.element.inputMode = this.inputMode;\n        this.element = undefined;\n    }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":["merge","fromEvent","filter","tuiGetNativeFocused","i0","DOCUMENT","Injectable","Inject"],"mappings":"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"}