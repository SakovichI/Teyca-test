"use strict";(self.webpackChunkteyca=self.webpackChunkteyca||[]).push([[270],{1270:(bt,I,o)=>{o.r(I),o.d(I,{routes:()=>Tt});var l=o(2615),H=o(7302),P=o(2782),D=o(6249),W=o(9595),T=o(9079),S=o(1255),u=o(4341),t=o(3664);let $=(()=>{class i extends S.dQ{initForm(e){const{firstName:n="",lastName:s="",template:a="\u0422\u0435\u0441\u0442\u043e\u0432\u044b\u0439",city:d="",gender:c="",phone:f="",email:x=""}=e||{},M=this.fb.group({firstName:this.fb.control(n,{nonNullable:!0,validators:u.k0.required}),lastName:this.fb.control(s,{nonNullable:!0,validators:u.k0.required}),template:this.fb.control(a,{nonNullable:!0,validators:u.k0.required}),city:this.fb.control(d,{nonNullable:!0,validators:u.k0.required}),gender:this.fb.control(c,{nonNullable:!0,validators:u.k0.required}),phone:this.fb.control(f,{nonNullable:!0,validators:u.k0.required}),email:this.fb.control(x,{nonNullable:!0,validators:[u.k0.required,u.k0.email]})});return this.setForm(M),this.$form()}static \u0275fac=(()=>{let e;return function(s){return(e||(e=t.xGo(i)))(s||i)}})();static \u0275prov=l.jDH({token:i,factory:i.\u0275fac})}return i})();var p=o(6901),E=o(7673),N=o(8141),b=o(980),Z=o(9437),V=o(6697),K=o(203),w=o(8875);let R=(()=>{class i{#t=(0,l.WQX)($);#e=(0,l.WQX)(p.lS);#l=(0,l.WQX)(w.D);#n=(0,l.WQX)(S.I2);#u=(0,l.WQX)(K.nX);#d=this.#u.snapshot.paramMap.get("id");$isEditable=(0,l.vPA)(!!this.id).asReadonly();#i=(0,l.vPA)(!1);#o=(0,l.vPA)(!0);$isSaving=this.#i.asReadonly();$isLoaded=this.#o.asReadonly();$form=this.#t.$form;get id(){return this.#d||""}initData(){return this.$isEditable()?this.#e.getClient(this.id).pipe((0,N.M)(n=>this.#t.initForm(n)),(0,b.j)(this.#r)):(this.#r(),(0,E.of)(null))}save(e){const n=this.id?p.g9.Edit:p.g9.Add,s=this.id?this.#e.updateClient(this.id,e):this.#e.addClient(e);return this.#s(s,n)}delete(){const e=this.#e.deleteClient(this.id);return this.#s(e,p.g9.Delete)}#s(e,n){return this.#a(!0),e.pipe((0,N.M)(()=>this.#c(n)),(0,Z.W)(c=>this.#h(c,n)),(0,b.j)(this.#a),(0,b.j)(()=>this.#l.refresh()))}#c(e){this.#n.showSuccess(`\u0423\u0434\u0430\u043b\u043e\u0441\u044c ${p.fj[e]} \u043a\u043b\u0438\u0435\u043d\u0442\u0430`).pipe((0,V.s)(1)).subscribe()}#h(e,n){return this.#n.showError(`\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c ${p.fj[n]} \u043a\u043b\u0438\u0435\u043d\u0442\u0430: ${e.error}`).pipe((0,V.s)(1)).subscribe(),(0,E.of)(null)}#a=(e=!1)=>this.#i.set(e);#r=(e=!1)=>this.#o.set(e);static \u0275fac=function(n){return new(n||i)};static \u0275prov=l.jDH({token:i,factory:i.\u0275fac})}return i})();var _=o(2200),O=o(7705),q=o(7218),h=o(5387),k=o(6686),y=o(2180),G=o(378),tt=o(9936),et=o(1635),v=o(5169),j=o(764),B=o(1813),nt=o(9925),U=o(683),it=o(8529),ot=o(1410),st=o(4343),F=o(9169),g=o(2630),A=o(8048),at=o(3584),z=o(3019),rt=o(7359),lt=o(987),L=o(9651),Y=o(8261);const ut=["*",[["input"]]],dt=["*","input"],Q=(0,nt.gc)({phoneMaskAfterCountryCode:"### ###-##-##",allowText:!1,countryCode:"+7"}),J=i=>i.replace(/\D/g,"").length;function ct(i,r){const e=(i+r).replace(/[^#\d]+/g,"").length,n=s=>s.replace("+7"===i?/^(\+?7?\s?8?)\s?/:new RegExp(`^(\\+?${i.replace("+","")}?)\\s?`),"");return({elementState:s,data:a})=>{const{value:d,selection:c}=s;return{elementState:{selection:c,value:J(d)>e?n(d):d},data:J(a)>=e?n(a):a}}}function C(i){return Number.isNaN(parseInt(i.replace(A.eO,""),10))}let pt=(()=>{class i extends U.Er{constructor(e,n,s,a,d){super(e,n),this.textfieldCleaner=s,this.options=a,this.textfieldSize=d,this.phoneMaskAfterCountryCode=this.options.phoneMaskAfterCountryCode,this.allowText=this.options.allowText,this.search="",this.searchChange=new t.bkB,this.countryCode=this.options.countryCode,this.open=!1}set countryCodeSetter(e){const n=this.countryCode;this.countryCode=e,this.updateValueWithNewCountryCode(n,e)}get size(){return this.textfieldSize.size}get nativeFocusableElement(){return!this.textfield||this.computedDisabled?null:this.textfield.nativeFocusableElement}get focused(){return(0,it.X)(this.nativeFocusableElement)||!!this.dropdown&&this.dropdown.focused}get nativeValue(){var e;return(null===(e=this.nativeFocusableElement)||void 0===e?void 0:e.value)||(0,v.bc)(this.value,this.maskOptions)}set nativeValue(e){this.nativeFocusableElement&&(this.nativeFocusableElement.value=e)}get inputMode(){return this.allowText?"text":"numeric"}get canOpen(){return this.interactive&&!!this.datalist}get canClean(){return this.nativeValue!==this.nonRemovablePrefix&&this.textfieldCleaner.cleaner}get maskOptions(){return this.calculateMask(this.countryCode,this.phoneMaskAfterCountryCode,this.nonRemovablePrefix,this.allowText)}onActiveZone(e){return this.updateFocused(e),!e||this.nativeValue||this.readOnly||this.allowText?this.nativeValue===this.nonRemovablePrefix||this.isTextValue?(this.updateSearch(""),void(this.nativeValue="")):void(!e&&!this.allowText&&this.nativeFocusableElement&&(this.nativeValue=this.nativeValue.replace(/\D$/,""))):(this.updateSearch(this.nonRemovablePrefix),void(this.nativeValue=this.nonRemovablePrefix))}onValueChange(e){const n=C(e)?e:e.replace(A.eO,"").slice(0,this.maxPhoneLength);this.updateSearch(n),this.value=n===this.countryCode||C(n)?"":n,this.open=!0,!this.value&&!this.allowText&&(this.nativeValue=this.nonRemovablePrefix)}handleOption(e){this.focusInput(),this.value=e,this.nativeValue=(0,v.bc)(this.value,this.maskOptions),this.updateSearch(""),this.open=!1}setDisabledState(){super.setDisabledState(),this.open=!1}writeValue(e){super.writeValue(e),this.nativeValue=(0,v.bc)(e||"",this.maskOptions),this.updateSearch("")}getFallbackValue(){return""}get nonRemovablePrefix(){return`${this.countryCode} `}get maxPhoneLength(){return this.countryCode.length+this.phoneMaskAfterCountryCode.replace(/[^#]+/g,"").length}get isTextValue(){return!!this.search&&C(this.search)}calculateMask(e,n,s,a){const d=function ht(i,r){return[...i.split("")," ",...r.replace(/[^#\- ()]+/g,"").split("").map(e=>"#"===e?/\d/:e)]}(e,n),c=[ct(e,n)];return a?{mask:({value:f})=>C(f)&&"+"!==f?v.oI.mask:d,preprocessors:c}:{mask:d,preprocessors:c,postprocessors:[(0,j.Kf)(s)],plugins:[(0,j.N_)((f,[x,M])=>[x===M?s.length:0,f.length])]}}focusInput(){this.nativeFocusableElement&&this.nativeFocusableElement.focus({preventScroll:!0})}updateSearch(e){this.search!==e&&(this.search=e,this.searchChange.emit(e))}updateValueWithNewCountryCode(e,n){this.isTextValue||(this.value=this.value.replace(e,n),this.nativeValue=(0,v.bc)(this.value,this.maskOptions))}}return i.\u0275fac=function(e){return new(e||i)(t.rXU(u.vO,10),t.rXU(O.gRc),t.rXU(h.u1),t.rXU(Q),t.rXU(h.tI))},i.\u0275cmp=t.VBU({type:i,selectors:[["tui-input-phone"]],contentQueries:function(e,n,s){if(1&e&&t.wni(s,at.WX,5,t.C4Q),2&e){let a;t.mGM(a=t.lsd())&&(n.datalist=a.first)}},viewQuery:function(e,n){if(1&e&&(t.GBs(F.o2,5),t.GBs(g.eD,5)),2&e){let s;t.mGM(s=t.lsd())&&(n.dropdown=s.first),t.mGM(s=t.lsd())&&(n.textfield=s.first)}},hostVars:1,hostBindings:function(e,n){2&e&&t.BMQ("data-size",n.size)},inputs:{countryCodeSetter:[0,"countryCode","countryCodeSetter"],phoneMaskAfterCountryCode:"phoneMaskAfterCountryCode",allowText:"allowText",search:"search"},outputs:{searchChange:"searchChange"},standalone:!1,features:[t.Jv_([(0,ot.Jr)(i),(0,U.SN)(i),(0,z.PU)(i)],[lt.MJ]),t.Vt3],ngContentSelectors:dt,decls:4,vars:13,consts:[[1,"t-hosted",3,"openChange","tuiActiveZoneChange","canOpen","content","open"],["tuiValueAccessor","",1,"t-textfield",3,"valueChange","disabled","focusable","invalid","maskito","nativeId","pseudoFocus","pseudoHover","readOnly","tuiTextfieldCleaner","value"]],template:function(e,n){1&e&&(t.NAR(ut),t.j41(0,"tui-hosted-dropdown",0),t.mxI("openChange",function(a){return t.DH7(n.open,a)||(n.open=a),a}),t.bIt("tuiActiveZoneChange",function(a){return n.onActiveZone(a)}),t.j41(1,"tui-primitive-textfield",1),t.mxI("valueChange",function(a){return t.DH7(n.nativeValue,a)||(n.nativeValue=a),a}),t.bIt("valueChange",function(a){return n.onValueChange(a)}),t.SdG(2),t.SdG(3,1,["ngProjectAs","input",5,["input"]]),t.k0s()()),2&e&&(t.Y8G("canOpen",n.canOpen)("content",n.datalist||""),t.R50("open",n.open),t.R7$(),t.Y8G("disabled",n.computedDisabled)("focusable",n.focusable)("invalid",n.computedInvalid)("maskito",n.maskOptions)("nativeId",n.nativeId)("pseudoFocus",n.computedFocused)("pseudoHover",n.pseudoHover)("readOnly",n.readOnly)("tuiTextfieldCleaner",n.canClean),t.R50("value",n.nativeValue))},dependencies:[F.o2,g.eD,B.Y,g.gt,L.a,Y.uj,h.np],styles:["[_nghost-%COMP%]{display:block;border-radius:var(--tui-radius-m);text-align:left}._disabled[_nghost-%COMP%]{pointer-events:none}.t-hosted[_ngcontent-%COMP%]{display:block;border-radius:inherit}.t-textfield[_ngcontent-%COMP%]{border-radius:inherit;text-align:inherit}"],changeDetection:0}),(0,et.Cg)([st.PE],i.prototype,"calculateMask",null),i})(),mt=(()=>{class i extends rt.aX{get value(){return this.host.nativeValue}onValueChange(e){this.host.onValueChange(e)}process(e){this.input=e}ngDoCheck(){this.input&&(this.input.type="tel",this.input.inputMode=this.host.inputMode)}}return i.\u0275fac=(()=>{let r;return function(n){return(r||(r=t.xGo(i)))(n||i)}})(),i.\u0275dir=t.FsC({type:i,selectors:[["tui-input-phone"]],standalone:!1,features:[t.Jv_([(0,z.Sc)(i)]),t.Vt3]}),i})(),ft=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.$C({type:i}),i.\u0275inj=l.G2t({imports:[[Y.rt,g.Rp,F.NT,h.CN,B.L,L.r]]}),i})();const m=()=>[];function vt(i,r){1&i&&(t.qex(0,0),t.j41(1,"div",1)(2,"label")(3,"tui-input",2),t.EFF(4," \u0418\u043c\u044f "),t.k0s(),t.nrm(5,"tui-error",3),t.nI1(6,"tuiFieldError"),t.nI1(7,"async"),t.k0s(),t.j41(8,"label")(9,"tui-input",4),t.EFF(10," \u0424\u0430\u043c\u0438\u043b\u0438\u044f "),t.k0s(),t.nrm(11,"tui-error",5),t.nI1(12,"tuiFieldError"),t.nI1(13,"async"),t.k0s()(),t.j41(14,"div",1)(15,"label")(16,"tui-input",6),t.EFF(17," \u041f\u043e\u043b "),t.k0s(),t.nrm(18,"tui-error",7),t.nI1(19,"tuiFieldError"),t.nI1(20,"async"),t.k0s(),t.j41(21,"label")(22,"tui-input",8),t.EFF(23," \u0413\u043e\u0440\u043e\u0434 "),t.k0s(),t.nrm(24,"tui-error",9),t.nI1(25,"tuiFieldError"),t.nI1(26,"async"),t.k0s()(),t.j41(27,"label")(28,"tui-input",10),t.EFF(29," \u041f\u043e\u0447\u0442\u0430 "),t.k0s(),t.nrm(30,"tui-error",9),t.nI1(31,"tuiFieldError"),t.nI1(32,"async"),t.k0s(),t.j41(33,"label")(34,"tui-input-phone",11),t.EFF(35," \u0422\u0435\u043b\u0435\u0444\u043e\u043d "),t.k0s(),t.nrm(36,"tui-error",12),t.nI1(37,"tuiFieldError"),t.nI1(38,"async"),t.k0s(),t.bVm()),2&i&&(t.Y8G("formGroup",r),t.R7$(3),t.Y8G("tuiTextfieldCleaner",!0),t.R7$(2),t.Y8G("error",t.bMT(7,15,t.bMT(6,13,t.lJ4(37,m)))),t.R7$(4),t.Y8G("tuiTextfieldCleaner",!0),t.R7$(2),t.Y8G("error",t.bMT(13,19,t.bMT(12,17,t.lJ4(38,m)))),t.R7$(5),t.Y8G("tuiTextfieldCleaner",!0),t.R7$(2),t.Y8G("error",t.bMT(20,23,t.bMT(19,21,t.lJ4(39,m)))),t.R7$(4),t.Y8G("tuiTextfieldCleaner",!0),t.R7$(2),t.Y8G("error",t.bMT(26,27,t.bMT(25,25,t.lJ4(40,m)))),t.R7$(4),t.Y8G("tuiTextfieldCleaner",!0),t.R7$(2),t.Y8G("error",t.bMT(32,31,t.bMT(31,29,t.lJ4(41,m)))),t.R7$(4),t.Y8G("tuiTextfieldCleaner",!0),t.R7$(2),t.Y8G("error",t.bMT(38,35,t.bMT(37,33,t.lJ4(42,m)))))}let gt=(()=>{class i{$form=O.hFB.required({alias:"form"});static \u0275fac=function(n){return new(n||i)};static \u0275cmp=t.VBU({type:i,selectors:[["app-clients-upsert-dialog-form"]],inputs:{$form:[1,"form","$form"]},decls:1,vars:1,consts:[[3,"formGroup"],[1,"form-row"],["formControlName","firstName","tuiTextfieldSize","m",3,"tuiTextfieldCleaner"],["formControlName","firstName",3,"error"],["formControlName","lastName","tuiTextfieldSize","m",3,"tuiTextfieldCleaner"],["formControlName","lastName",3,"error"],["formControlName","gender","tuiTextfieldSize","m",3,"tuiTextfieldCleaner"],["formControlName","gender",3,"error"],["formControlName","city","tuiTextfieldSize","m",3,"tuiTextfieldCleaner"],["formControlName","city",3,"error"],["formControlName","email","tuiTextfieldSize","m",3,"tuiTextfieldCleaner"],["formControlName","phone","tuiTextfieldSize","m",3,"tuiTextfieldCleaner"],["formControlName","phone",3,"error"]],template:function(n,s){if(1&n&&t.nVh(0,vt,39,43,"ng-container",0),2&n){let a;t.vxM((a=s.$form())?0:-1,a)}},dependencies:[u.X1,u.BC,u.cb,u.j4,u.JD,y.zi,y.mp,y.Ws,q.F,h.CN,h.np,h.G6,G.Hi,tt.Qw,k.F,k.u,ft,pt,mt,G.bs,_.Jj],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:var(--spacing-3x)}[_nghost-%COMP%]   .form-row[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-3x)}[_nghost-%COMP%]   .form-row[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:1 1 50%}"]})}return i})();function Ct(i,r){if(1&i){const e=t.RV6();t.j41(0,"button",8),t.bIt("click",function(){l.eBV(e);const s=t.XpG();return l.Njj(s.onDelete())}),t.EFF(1," \u0423\u0434\u0430\u043b\u0438\u0442\u044c "),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("disabled",e.$isSaving())("showLoader",e.$isSaving())}}const Tt=[((i,{path:r="",...e}={})=>({path:r,loadComponent:()=>o.e(921).then(o.bind(o,4921)).then(n=>n.RoutableDialogComponent),data:{dialog:i,isLazy:!0,dialogOptions:e}}))((()=>{class i extends W.CloseConfirmationDialogHandler{#t=(0,l.WQX)(R);$isSaving=this.#t.$isSaving;$isLoaded=this.#t.$isLoaded;$form=this.#t.$form;$isEditable=this.#t.$isEditable;ngOnInit(){this.#e()}#e(){this.#t.initData().pipe((0,T.pQ)(this.destroyRef)).subscribe()}onSave(){this.#t.save(this.$form().getRawValue()).pipe((0,T.pQ)(this.destroyRef)).subscribe(()=>this.close())}onDelete(){this.#t.delete().pipe((0,T.pQ)(this.destroyRef)).subscribe(()=>this.close())}onClose(){this.close()}static \u0275fac=(()=>{let e;return function(s){return(e||(e=t.xGo(i)))(s||i)}})();static \u0275cmp=t.VBU({type:i,selectors:[["app-clients-upsert-dialog"]],features:[t.Jv_([H._T,R,$]),t.Vt3],decls:11,vars:8,consts:[[1,"title"],[3,"overlay","showLoader"],[1,"content"],[3,"form"],[1,"actions"],["type","button","tuiButton","","size","m","appearance","secondary",3,"click"],["type","button","appearance","accent","tuiButton","","size","m",3,"disabled","showLoader"],["type","button","tuiButton","","size","m",3,"click","disabled","showLoader"],["type","button","appearance","accent","tuiButton","","size","m",3,"click","disabled","showLoader"]],template:function(n,s){if(1&n){const a=t.RV6();t.j41(0,"h2",0),t.EFF(1),t.k0s(),t.j41(2,"tui-loader",1)(3,"div",2),t.nrm(4,"app-clients-upsert-dialog-form",3),t.k0s(),t.j41(5,"div",4)(6,"button",5),t.bIt("click",function(){return l.eBV(a),l.Njj(s.onClose())}),t.EFF(7," \u041e\u0442\u043c\u0435\u043d\u0430 "),t.k0s(),t.nVh(8,Ct,2,2,"button",6),t.j41(9,"button",7),t.bIt("click",function(){return l.eBV(a),l.Njj(s.onSave())}),t.EFF(10),t.k0s()()()}if(2&n){const a=s.$isEditable()?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435":"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435";t.R7$(),t.SpI("",a," \u043a\u043b\u0438\u0435\u043d\u0442\u0430"),t.R7$(),t.Y8G("overlay",!0)("showLoader",s.$isLoaded()),t.R7$(2),t.Y8G("form",s.$form()),t.R7$(4),t.vxM(s.$isEditable()?8:-1),t.R7$(),t.Y8G("disabled",s.$form().invalid||s.$isSaving())("showLoader",s.$isSaving()),t.R7$(),t.SpI(" ",s.$isEditable()?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"," ")}},dependencies:[P.Pv,P.SM,D.Yc,D.jT,gt],styles:[".title[_ngcontent-%COMP%]{margin-bottom:var(--spacing-6x);font-size:1.75rem;font-weight:500;line-height:2rem}.content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--spacing-6x);margin-bottom:var(--spacing-6x)}.actions[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-2x);justify-content:flex-end;margin-top:var(--spacing-6x)}"],changeDetection:0})}return i})(),{size:"l",closeable:!0,dismissible:!1})]}}]);