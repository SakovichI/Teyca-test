{"ast":null,"code":"import * as i0 from '@angular/core';\nimport { EventEmitter, Component, ChangeDetectionStrategy, Inject, Input, Output, HostListener, NgModule } from '@angular/core';\nimport { TUI_TABLE_SHOW_HIDE_MESSAGE } from '@taiga-ui/addon-table/tokens';\nimport { tuiCreateToken, tuiProvideOptions } from '@taiga-ui/cdk';\nimport * as i1 from '@taiga-ui/kit';\nimport { TuiTilesModule } from '@taiga-ui/kit';\nimport * as i2 from '@taiga-ui/core';\nimport { TuiSvgModule, TuiButtonModule } from '@taiga-ui/core';\nimport * as i3 from '@angular/common';\nimport { CommonModule } from '@angular/common';\nimport * as i4 from '@tinkoff/ng-polymorpheus';\nimport { PolymorpheusModule } from '@tinkoff/ng-polymorpheus';\nimport * as i5 from 'rxjs';\nconst _c0 = (a0, a1) => ({\n  $implicit: a0,\n  index: a1\n});\nfunction TuiReorderComponent_tui_tile_1_ng_container_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const template_r2 = ctx.polymorpheusOutlet;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", template_r2, \" \");\n  }\n}\nfunction TuiReorderComponent_tui_tile_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tui-tile\")(1, \"div\", 2)(2, \"div\", 3);\n    i0.ɵɵelement(3, \"tui-svg\", 4);\n    i0.ɵɵtemplate(4, TuiReorderComponent_tui_tile_1_ng_container_4_Template, 2, 1, \"ng-container\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"button\", 6);\n    i0.ɵɵpipe(6, \"async\");\n    i0.ɵɵlistener(\"click\", function TuiReorderComponent_tui_tile_1_Template_button_click_5_listener() {\n      const item_r3 = i0.ɵɵrestoreView(_r1).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.toggle(item_r3));\n    })(\"keydown.arrowDown.prevent\", function TuiReorderComponent_tui_tile_1_Template_button_keydown_arrowDown_prevent_5_listener() {\n      const index_r5 = i0.ɵɵrestoreView(_r1).index;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.move(index_r5, 1));\n    })(\"keydown.arrowUp.prevent\", function TuiReorderComponent_tui_tile_1_Template_button_keydown_arrowUp_prevent_5_listener() {\n      const index_r5 = i0.ɵɵrestoreView(_r1).index;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.move(index_r5, -1));\n    });\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const item_r3 = ctx.$implicit;\n    const index_r5 = ctx.index;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵstyleProp(\"order\", ctx_r3.order.get(index_r5));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"src\", ctx_r3.options.icons.drag);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"polymorpheusOutlet\", ctx_r3.content)(\"polymorpheusOutletContext\", i0.ɵɵpureFunction2(11, _c0, item_r3, index_r5));\n    i0.ɵɵadvance();\n    i0.ɵɵclassProp(\"t-button_hidden\", !ctx_r3.isEnabled(item_r3));\n    i0.ɵɵproperty(\"icon\", ctx_r3.getIcon(item_r3))(\"title\", i0.ɵɵpipeBind1(6, 9, ctx_r3.showHideText$));\n  }\n}\nconst TUI_REORDER_DEFAULT_OPTIONS = {\n  icons: {\n    hide: 'tuiIconEye',\n    show: 'tuiIconEyeOff',\n    drag: 'tuiIconDrag'\n  }\n};\nconst TUI_REORDER_OPTIONS = tuiCreateToken(TUI_REORDER_DEFAULT_OPTIONS);\nfunction tuiReorderOptionsProvider(options) {\n  return tuiProvideOptions(TUI_REORDER_OPTIONS, options, TUI_REORDER_DEFAULT_OPTIONS);\n}\nlet TuiReorderComponent = /*#__PURE__*/(() => {\n  class TuiReorderComponent {\n    constructor(options, showHideText$) {\n      this.options = options;\n      this.showHideText$ = showHideText$;\n      this.dragging = false;\n      this.enabled = [];\n      this.itemsChange = new EventEmitter();\n      this.enabledChange = new EventEmitter();\n      this.order = new Map();\n      this.unsortedItems = [];\n      this.content = ({\n        $implicit\n      }) => String($implicit);\n    }\n    set items(items) {\n      if (items.length !== this.unsortedItems.length || !items.every(item => this.unsortedItems.includes(item))) {\n        this.unsortedItems = items;\n      }\n    }\n    noop() {}\n    onDrag() {\n      this.dragging = true;\n    }\n    onDrop() {\n      if (!this.dragging) {\n        return;\n      }\n      this.dragging = false;\n      this.updateItems();\n    }\n    isEnabled(item) {\n      return this.enabled.includes(item);\n    }\n    getIcon(item) {\n      return this.isEnabled(item) ? this.options.icons.hide : this.options.icons.show;\n    }\n    toggle(toggled) {\n      this.enabled = this.isEnabled(toggled) ? this.enabled.filter(item => item !== toggled) : this.enabled.concat(toggled);\n      this.updateEnabled();\n    }\n    move(index, direction) {\n      var _a;\n      const oldIndex = (_a = this.order.get(index)) !== null && _a !== void 0 ? _a : index;\n      if (!oldIndex && direction < 0 || oldIndex === this.unsortedItems.length - 1 && direction > 0) {\n        return;\n      }\n      const newIndex = oldIndex + direction;\n      const oldItem = Array.from(this.order.values()).findIndex(item => item === newIndex);\n      this.order.set(index, newIndex);\n      this.order.set(oldItem, oldIndex);\n      this.order = new Map(this.order);\n      this.updateItems();\n    }\n    getSortedItems() {\n      const items = new Array(this.unsortedItems.length);\n      this.unsortedItems.forEach((item, index) => {\n        var _a;\n        items[(_a = this.order.get(index)) !== null && _a !== void 0 ? _a : index] = item;\n      });\n      return items;\n    }\n    updateItems() {\n      this.itemsChange.emit(this.getSortedItems());\n      this.updateEnabled();\n    }\n    updateEnabled() {\n      const enabled = this.getSortedItems().filter(item => this.isEnabled(item));\n      this.enabled = enabled;\n      this.enabledChange.emit(enabled);\n    }\n  }\n  TuiReorderComponent.ɵfac = function TuiReorderComponent_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || TuiReorderComponent)(i0.ɵɵdirectiveInject(TUI_REORDER_OPTIONS), i0.ɵɵdirectiveInject(TUI_TABLE_SHOW_HIDE_MESSAGE));\n  };\n  TuiReorderComponent.ɵcmp = /* @__PURE__ */i0.ɵɵdefineComponent({\n    type: TuiReorderComponent,\n    selectors: [[\"tui-reorder\"]],\n    hostBindings: function TuiReorderComponent_HostBindings(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵlistener(\"focusout.stop\", function TuiReorderComponent_focusout_stop_HostBindingHandler() {\n          return ctx.noop();\n        })(\"pointerdown.silent\", function TuiReorderComponent_pointerdown_silent_HostBindingHandler() {\n          return ctx.onDrag();\n        })(\"pointerup.silent\", function TuiReorderComponent_pointerup_silent_HostBindingHandler() {\n          return ctx.onDrop();\n        }, i0.ɵɵresolveDocument);\n      }\n    },\n    inputs: {\n      items: \"items\",\n      enabled: \"enabled\",\n      content: \"content\"\n    },\n    outputs: {\n      itemsChange: \"itemsChange\",\n      enabledChange: \"enabledChange\"\n    },\n    standalone: false,\n    decls: 2,\n    vars: 2,\n    consts: [[1, \"t-wrapper\", 3, \"orderChange\", \"order\"], [3, \"order\", 4, \"ngFor\", \"ngForOf\"], [1, \"t-item\"], [\"tuiTileHandle\", \"\", 1, \"t-draggable\"], [1, \"t-icon\", 3, \"src\"], [4, \"polymorpheusOutlet\", \"polymorpheusOutletContext\"], [\"appearance\", \"icon\", \"size\", \"xs\", \"tuiIconButton\", \"\", \"type\", \"button\", 1, \"t-button\", 3, \"click\", \"keydown.arrowDown.prevent\", \"keydown.arrowUp.prevent\", \"icon\", \"title\"]],\n    template: function TuiReorderComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"tui-tiles\", 0);\n        i0.ɵɵtwoWayListener(\"orderChange\", function TuiReorderComponent_Template_tui_tiles_orderChange_0_listener($event) {\n          i0.ɵɵtwoWayBindingSet(ctx.order, $event) || (ctx.order = $event);\n          return $event;\n        });\n        i0.ɵɵtemplate(1, TuiReorderComponent_tui_tile_1_Template, 7, 14, \"tui-tile\", 1);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵtwoWayProperty(\"order\", ctx.order);\n        i0.ɵɵadvance();\n        i0.ɵɵproperty(\"ngForOf\", ctx.unsortedItems);\n      }\n    },\n    dependencies: [i1.TuiTilesComponent, i1.TuiTileComponent, i2.TuiSvgComponent, i2.TuiButtonComponent, i3.NgForOf, i1.TuiTileHandleDirective, i4.PolymorpheusOutletDirective, i3.AsyncPipe],\n    styles: [\"[_nghost-%COMP%]{display:block;font:var(--tui-font-text-s);padding:.5rem 0;-webkit-user-select:none;-moz-user-select:none;user-select:none}.t-wrapper[_ngcontent-%COMP%]{grid-auto-rows:2rem}.t-draggable[_ngcontent-%COMP%]{cursor:ns-resize;flex:1 1 auto}.t-item[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;display:flex;height:2rem;align-items:center;padding:0 .75rem;background:var(--tui-base-01)}.t-item[_ngcontent-%COMP%]:hover{background:var(--tui-base-02)}.t-item[_ngcontent-%COMP%]:hover   .t-button[_ngcontent-%COMP%]{opacity:1}.t-icon[_ngcontent-%COMP%]{margin-right:.5rem;color:var(--tui-base-05)}.t-button[_ngcontent-%COMP%]{transition-property:opacity;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;margin-left:auto;opacity:0}.t-button_hidden[_ngcontent-%COMP%], .t-button[_ngcontent-%COMP%]:focus{opacity:1}\"],\n    changeDetection: 0\n  });\n  return TuiReorderComponent;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nlet TuiReorderModule = /*#__PURE__*/(() => {\n  class TuiReorderModule {}\n  TuiReorderModule.ɵfac = function TuiReorderModule_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || TuiReorderModule)();\n  };\n  TuiReorderModule.ɵmod = /* @__PURE__ */i0.ɵɵdefineNgModule({\n    type: TuiReorderModule\n  });\n  TuiReorderModule.ɵinj = /* @__PURE__ */i0.ɵɵdefineInjector({\n    imports: [[CommonModule, TuiSvgModule, TuiButtonModule, TuiTilesModule, PolymorpheusModule]]\n  });\n  return TuiReorderModule;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { TUI_REORDER_DEFAULT_OPTIONS, TUI_REORDER_OPTIONS, TuiReorderComponent, TuiReorderModule, tuiReorderOptionsProvider };\n//# sourceMappingURL=taiga-ui-addon-table-components-reorder.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}