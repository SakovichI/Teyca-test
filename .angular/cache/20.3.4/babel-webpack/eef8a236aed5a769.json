{"ast":null,"code":"import * as i0 from '@angular/core';\nimport { EventEmitter, ChangeDetectorRef, TemplateRef, Component, ChangeDetectionStrategy, Optional, Self, Inject, ContentChild, ViewChild, Input, Output, HostBinding, Directive, HostListener, NgModule } from '@angular/core';\nimport * as i5 from '@angular/forms';\nimport { NgControl } from '@angular/forms';\nimport * as i2 from '@taiga-ui/cdk';\nimport { AbstractTuiNullableControl, TUI_STRICT_MATCHER, tuiIsNativeFocused, tuiIsPresent, tuiAsFocusableItemAccessor, tuiAsControl, TuiActiveZoneModule } from '@taiga-ui/cdk';\nimport * as i1 from '@taiga-ui/core';\nimport { TUI_TEXTFIELD_SIZE, tuiAsDataListHost, tuiAsOptionContent, TUI_DATA_LIST_ACCESSOR, TuiDataListDirective, TuiHostedDropdownComponent, TuiPrimitiveTextfieldComponent, AbstractTuiTextfieldHost, tuiAsTextfieldHost, TuiPrimitiveTextfieldModule, TuiHostedDropdownModule, TuiWrapperModule, TuiTextfieldControllerModule, TuiTextfieldComponent } from '@taiga-ui/core';\nimport { TUI_ARROW_MODE, TuiArrowModule } from '@taiga-ui/kit/components/arrow';\nimport { TUI_SELECT_OPTION, TuiSelectOptionModule } from '@taiga-ui/kit/components/select-option';\nimport { FIXED_DROPDOWN_CONTROLLER_PROVIDER } from '@taiga-ui/kit/providers';\nimport { TUI_ITEMS_HANDLERS } from '@taiga-ui/kit/tokens';\nimport * as i3 from '@angular/common';\nimport { CommonModule } from '@angular/common';\nimport * as i4 from '@tinkoff/ng-polymorpheus';\nimport { PolymorpheusModule } from '@tinkoff/ng-polymorpheus';\nconst _c0 = [\"*\", [[\"input\"]]];\nconst _c1 = [\"*\", \"input\"];\nconst _c2 = (a0, a1) => ({\n  $implicit: a0,\n  active: a1\n});\nfunction TuiComboBoxComponent_div_4_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const text_r2 = ctx.polymorpheusOutlet;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", text_r2, \" \");\n  }\n}\nfunction TuiComboBoxComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 4);\n    i0.ɵɵtemplate(1, TuiComboBoxComponent_div_4_ng_container_1_Template, 2, 1, \"ng-container\", 5);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"polymorpheusOutlet\", ctx_r2.computedContent)(\"polymorpheusOutletContext\", i0.ɵɵpureFunction2(2, _c2, ctx_r2.value, ctx_r2.computedFocused));\n  }\n}\nfunction TuiComboBoxComponent_ng_template_5_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainer(0);\n  }\n}\nfunction TuiComboBoxComponent_ng_template_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵtemplate(1, TuiComboBoxComponent_ng_template_5_ng_container_1_Template, 1, 0, \"ng-container\", 7);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"polymorpheusOutlet\", ctx_r2.arrow);\n  }\n}\nlet TuiComboBoxComponent = /*#__PURE__*/(() => {\n  class TuiComboBoxComponent extends AbstractTuiNullableControl {\n    constructor(control, cdr, arrowMode, itemsHandlers, textfieldSize) {\n      super(control, cdr);\n      this.arrowMode = arrowMode;\n      this.itemsHandlers = itemsHandlers;\n      this.textfieldSize = textfieldSize;\n      this.stringify = this.itemsHandlers.stringify;\n      this.strictMatcher = TUI_STRICT_MATCHER;\n      this.identityMatcher = this.itemsHandlers.identityMatcher;\n      this.strict = true;\n      this.search = null;\n      this.searchChange = new EventEmitter();\n      this.open = false;\n    }\n    get size() {\n      return this.textfieldSize.size;\n    }\n    get arrow() {\n      return !this.interactive ? this.arrowMode.disabled : this.arrowMode.interactive;\n    }\n    get nativeFocusableElement() {\n      var _a, _b;\n      return (_b = (_a = this.textfield) === null || _a === void 0 ? void 0 : _a.nativeFocusableElement) !== null && _b !== void 0 ? _b : null;\n    }\n    get focused() {\n      var _a;\n      return tuiIsNativeFocused(this.nativeFocusableElement) || !!((_a = this.hostedDropdown) === null || _a === void 0 ? void 0 : _a.focused);\n    }\n    get nativeValue() {\n      return this.value === null ? this.search || '' : this.stringify(this.value);\n    }\n    get showValueTemplate() {\n      return tuiIsPresent(this.value) && !this.focused;\n    }\n    get computedContent() {\n      return this.valueContent || this.nativeValue;\n    }\n    onActiveZone(active) {\n      this.updateFocused(active);\n    }\n    checkOption(option) {\n      if (!this.isStrictMatch(option)) {\n        return;\n      }\n      this.value = option;\n      this.updateSearch(null);\n    }\n    handleOption(item) {\n      this.focusInput();\n      this.close();\n      this.updateSearch(null);\n      this.value = item;\n      if (this.value) {\n        this.setNativeValue(this.stringify(item));\n      }\n    }\n    onFieldKeyDownEnter(event) {\n      var _a;\n      if (this.open) {\n        event.preventDefault();\n      }\n      const options = ((_a = this.accessor) === null || _a === void 0 ? void 0 : _a.getOptions()) || [];\n      if (options.length !== 1) {\n        return;\n      }\n      this.value = options[0];\n      this.updateSearch(null);\n      this.close();\n    }\n    onValueChange(value) {\n      var _a, _b;\n      this.updateSearch(value);\n      const match = (_a = this.accessor) === null || _a === void 0 ? void 0 : _a.getOptions().find(item => this.isStrictMatch(item));\n      if (match !== undefined) {\n        this.value = match;\n        this.updateSearch(null);\n        return;\n      }\n      if (this.strict || this.search === '') {\n        this.value = null;\n      }\n      // Clearing sets the empty value, the dropdown should not be opened on clear.\n      if (this.search !== '') {\n        (_b = this.hostedDropdown) === null || _b === void 0 ? void 0 : _b.updateOpen(true);\n      }\n    }\n    /** @deprecated use 'value' setter */\n    updateValue(value) {\n      super.updateValue(value);\n    }\n    toggle() {\n      var _a;\n      (_a = this.hostedDropdown) === null || _a === void 0 ? void 0 : _a.updateOpen(!this.open);\n    }\n    isStrictMatch(item) {\n      var _a;\n      return !!this.search && !!((_a = this.strictMatcher) === null || _a === void 0 ? void 0 : _a.call(this, item, this.search, this.stringify));\n    }\n    close() {\n      var _a;\n      (_a = this.hostedDropdown) === null || _a === void 0 ? void 0 : _a.updateOpen(false);\n    }\n    updateSearch(search) {\n      if (this.search === search) {\n        return;\n      }\n      this.search = search;\n      this.searchChange.emit(search);\n    }\n    setNativeValue(value) {\n      if (this.nativeFocusableElement) {\n        this.nativeFocusableElement.value = value;\n      }\n    }\n    focusInput(preventScroll = false) {\n      if (this.nativeFocusableElement) {\n        this.nativeFocusableElement.focus({\n          preventScroll\n        });\n      }\n    }\n  }\n  TuiComboBoxComponent.ɵfac = function TuiComboBoxComponent_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || TuiComboBoxComponent)(i0.ɵɵdirectiveInject(NgControl, 10), i0.ɵɵdirectiveInject(ChangeDetectorRef), i0.ɵɵdirectiveInject(TUI_ARROW_MODE), i0.ɵɵdirectiveInject(TUI_ITEMS_HANDLERS), i0.ɵɵdirectiveInject(TUI_TEXTFIELD_SIZE));\n  };\n  TuiComboBoxComponent.ɵcmp = /* @__PURE__ */i0.ɵɵdefineComponent({\n    type: TuiComboBoxComponent,\n    selectors: [[\"tui-combo-box\"]],\n    contentQueries: function TuiComboBoxComponent_ContentQueries(rf, ctx, dirIndex) {\n      if (rf & 1) {\n        i0.ɵɵcontentQuery(dirIndex, TUI_DATA_LIST_ACCESSOR, 5);\n        i0.ɵɵcontentQuery(dirIndex, TuiDataListDirective, 5, TemplateRef);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.accessor = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.datalist = _t.first);\n      }\n    },\n    viewQuery: function TuiComboBoxComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(TuiHostedDropdownComponent, 5);\n        i0.ɵɵviewQuery(TuiPrimitiveTextfieldComponent, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.hostedDropdown = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.textfield = _t.first);\n      }\n    },\n    hostVars: 1,\n    hostBindings: function TuiComboBoxComponent_HostBindings(rf, ctx) {\n      if (rf & 2) {\n        i0.ɵɵattribute(\"data-size\", ctx.size);\n      }\n    },\n    inputs: {\n      stringify: \"stringify\",\n      strictMatcher: \"strictMatcher\",\n      identityMatcher: \"identityMatcher\",\n      valueContent: \"valueContent\",\n      strict: \"strict\",\n      search: \"search\"\n    },\n    outputs: {\n      searchChange: \"searchChange\"\n    },\n    standalone: false,\n    features: [i0.ɵɵProvidersFeature([tuiAsFocusableItemAccessor(TuiComboBoxComponent), tuiAsDataListHost(TuiComboBoxComponent), tuiAsControl(TuiComboBoxComponent), tuiAsOptionContent(TUI_SELECT_OPTION)], [FIXED_DROPDOWN_CONTROLLER_PROVIDER]), i0.ɵɵInheritDefinitionFeature],\n    ngContentSelectors: _c1,\n    decls: 7,\n    vars: 13,\n    consts: [[\"icon\", \"\"], [1, \"t-hosted\", 3, \"openChange\", \"tuiActiveZoneChange\", \"canOpen\", \"content\", \"open\"], [\"automation-id\", \"tui-combo-box__textfield\", 1, \"t-textfield\", 3, \"click\", \"keydown.enter\", \"valueChange\", \"disabled\", \"focusable\", \"invalid\", \"nativeId\", \"pseudoFocus\", \"pseudoHover\", \"readOnly\", \"tuiTextfieldIcon\", \"value\"], [\"automation-id\", \"tui-combo-box__template\", \"ngProjectAs\", \"tuiContent\", \"class\", \"t-value\", 5, [\"tuiContent\"], 4, \"ngIf\"], [\"automation-id\", \"tui-combo-box__template\", \"ngProjectAs\", \"tuiContent\", 5, [\"tuiContent\"], 1, \"t-value\"], [4, \"polymorpheusOutlet\", \"polymorpheusOutletContext\"], [\"appearance\", \"icon\", \"tuiWrapper\", \"\", 1, \"t-icon\"], [4, \"polymorpheusOutlet\"]],\n    template: function TuiComboBoxComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r1 = i0.ɵɵgetCurrentView();\n        i0.ɵɵprojectionDef(_c0);\n        i0.ɵɵelementStart(0, \"tui-hosted-dropdown\", 1);\n        i0.ɵɵtwoWayListener(\"openChange\", function TuiComboBoxComponent_Template_tui_hosted_dropdown_openChange_0_listener($event) {\n          i0.ɵɵrestoreView(_r1);\n          i0.ɵɵtwoWayBindingSet(ctx.open, $event) || (ctx.open = $event);\n          return i0.ɵɵresetView($event);\n        });\n        i0.ɵɵlistener(\"tuiActiveZoneChange\", function TuiComboBoxComponent_Template_tui_hosted_dropdown_tuiActiveZoneChange_0_listener($event) {\n          i0.ɵɵrestoreView(_r1);\n          return i0.ɵɵresetView(ctx.onActiveZone($event));\n        });\n        i0.ɵɵelementStart(1, \"tui-primitive-textfield\", 2);\n        i0.ɵɵlistener(\"click\", function TuiComboBoxComponent_Template_tui_primitive_textfield_click_1_listener() {\n          i0.ɵɵrestoreView(_r1);\n          return i0.ɵɵresetView(ctx.toggle());\n        })(\"keydown.enter\", function TuiComboBoxComponent_Template_tui_primitive_textfield_keydown_enter_1_listener($event) {\n          i0.ɵɵrestoreView(_r1);\n          return i0.ɵɵresetView(ctx.onFieldKeyDownEnter($event));\n        })(\"valueChange\", function TuiComboBoxComponent_Template_tui_primitive_textfield_valueChange_1_listener($event) {\n          i0.ɵɵrestoreView(_r1);\n          return i0.ɵɵresetView(ctx.onValueChange($event));\n        });\n        i0.ɵɵprojection(2);\n        i0.ɵɵprojection(3, 1, [\"ngProjectAs\", \"input\", 5, [\"input\"]]);\n        i0.ɵɵtemplate(4, TuiComboBoxComponent_div_4_Template, 2, 5, \"div\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(5, TuiComboBoxComponent_ng_template_5_Template, 2, 1, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        const icon_r4 = i0.ɵɵreference(6);\n        i0.ɵɵproperty(\"canOpen\", ctx.interactive && !!ctx.datalist)(\"content\", ctx.datalist || \"\");\n        i0.ɵɵtwoWayProperty(\"open\", ctx.open);\n        i0.ɵɵadvance();\n        i0.ɵɵproperty(\"disabled\", ctx.computedDisabled)(\"focusable\", ctx.computedFocusable)(\"invalid\", ctx.computedInvalid)(\"nativeId\", ctx.nativeId)(\"pseudoFocus\", ctx.computedFocused)(\"pseudoHover\", ctx.pseudoHover)(\"readOnly\", ctx.readOnly)(\"tuiTextfieldIcon\", ctx.arrow ? icon_r4 : \"\")(\"value\", ctx.nativeValue);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.showValueTemplate);\n      }\n    },\n    dependencies: [i1.TuiHostedDropdownComponent, i1.TuiPrimitiveTextfieldComponent, i2.TuiActiveZoneDirective, i1.TuiPrimitiveTextfieldDirective, i1.TuiTextfieldIconDirective, i3.NgIf, i4.PolymorpheusOutletDirective, i1.TuiWrapperDirective],\n    styles: [\"[_nghost-%COMP%]{display:block;border-radius:var(--tui-radius-m);text-align:left}.t-hosted[_ngcontent-%COMP%]{display:block;border-radius:inherit}.t-textfield[_ngcontent-%COMP%]{border-radius:inherit;text-align:inherit}.t-value[_ngcontent-%COMP%]{display:flex;width:100%;align-items:center}.t-icon[_ngcontent-%COMP%]{pointer-events:auto}\"],\n    changeDetection: 0\n  });\n  return TuiComboBoxComponent;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nlet TuiComboBoxDirective = /*#__PURE__*/(() => {\n  class TuiComboBoxDirective extends AbstractTuiTextfieldHost {\n    get value() {\n      return this.host.nativeValue;\n    }\n    onValueChange(value) {\n      this.host.onValueChange(value);\n    }\n  }\n  TuiComboBoxDirective.ɵfac = /* @__PURE__ */(() => {\n    let ɵTuiComboBoxDirective_BaseFactory;\n    return function TuiComboBoxDirective_Factory(__ngFactoryType__) {\n      return (ɵTuiComboBoxDirective_BaseFactory || (ɵTuiComboBoxDirective_BaseFactory = i0.ɵɵgetInheritedFactory(TuiComboBoxDirective)))(__ngFactoryType__ || TuiComboBoxDirective);\n    };\n  })();\n  TuiComboBoxDirective.ɵdir = /* @__PURE__ */i0.ɵɵdefineDirective({\n    type: TuiComboBoxDirective,\n    selectors: [[\"tui-combo-box\"]],\n    standalone: false,\n    features: [i0.ɵɵProvidersFeature([tuiAsTextfieldHost(TuiComboBoxDirective)]), i0.ɵɵInheritDefinitionFeature]\n  });\n  return TuiComboBoxDirective;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nlet TuiComboBoxStrictDirective = /*#__PURE__*/(() => {\n  class TuiComboBoxStrictDirective {\n    constructor(comboBox) {\n      this.comboBox = comboBox;\n      this.strict = true;\n    }\n    onInput() {\n      if (!this.strict && this.comboBox.search) {\n        this.comboBox.value = this.comboBox.search;\n      }\n    }\n  }\n  TuiComboBoxStrictDirective.ɵfac = function TuiComboBoxStrictDirective_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || TuiComboBoxStrictDirective)(i0.ɵɵdirectiveInject(TuiComboBoxComponent));\n  };\n  TuiComboBoxStrictDirective.ɵdir = /* @__PURE__ */i0.ɵɵdefineDirective({\n    type: TuiComboBoxStrictDirective,\n    selectors: [[\"tui-combo-box\", \"strict\", \"\"]],\n    hostBindings: function TuiComboBoxStrictDirective_HostBindings(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵlistener(\"input\", function TuiComboBoxStrictDirective_input_HostBindingHandler() {\n          return ctx.onInput();\n        });\n      }\n    },\n    inputs: {\n      strict: \"strict\"\n    },\n    standalone: false\n  });\n  return TuiComboBoxStrictDirective;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nlet TuiComboBoxModule = /*#__PURE__*/(() => {\n  class TuiComboBoxModule {}\n  TuiComboBoxModule.ɵfac = function TuiComboBoxModule_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || TuiComboBoxModule)();\n  };\n  TuiComboBoxModule.ɵmod = /* @__PURE__ */i0.ɵɵdefineNgModule({\n    type: TuiComboBoxModule\n  });\n  TuiComboBoxModule.ɵinj = /* @__PURE__ */i0.ɵɵdefineInjector({\n    imports: [[CommonModule, PolymorpheusModule, TuiActiveZoneModule, TuiPrimitiveTextfieldModule, TuiHostedDropdownModule, TuiSelectOptionModule, TuiArrowModule, TuiWrapperModule, TuiTextfieldControllerModule]]\n  });\n  return TuiComboBoxModule;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { TuiComboBoxComponent, TuiComboBoxDirective, TuiComboBoxModule, TuiComboBoxStrictDirective };\n//# sourceMappingURL=taiga-ui-kit-components-combo-box.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}